<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>LoL Pro Draft Simulator v0.2 (beta)</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="styles/main.css?v=20260227-20">
</head>
<body>

<div id="home-page" class="home-page">
    <div class="home-card">
        <h1 class="home-title">LoL Banpick Simulator</h1>
        <p class="home-version">v0.2 (beta)</p>
        <p class="home-desc">모드를 고르고 팀 이름/전략을 설정한 뒤 밴픽으로 승패를 가르는 게임입니다.</p>
        <div class="home-team-setup" id="home-team-setup">
            <div class="home-input-wrap">
                <label for="my-team-name">내 팀 이름</label>
                <input id="my-team-name" type="text" maxlength="24" placeholder="MY TEAM">
            </div>
            <div class="home-input-wrap">
                <label for="ai-team-name">AI 팀 이름</label>
                <input id="ai-team-name" type="text" maxlength="24" placeholder="AI TEAM">
            </div>
            <button type="button" class="home-save-btn" onclick="saveTeamNameInputs()">팀 이름 저장</button>
        </div>
        <div id="home-worlds-team-panel" class="home-worlds-team-panel hidden">
            <div class="home-worlds-head">
                <div id="home-worlds-team-title" class="home-worlds-team-title">실제 선수 모드 팀</div>
                <button type="button" class="home-save-btn small" onclick="requestWorldsTeamChange()">팀 변경</button>
            </div>
            <div id="home-worlds-roster" class="home-worlds-roster"></div>
        </div>
        <div class="mode-grid">
            <button type="button" class="mode-btn" onclick="selectMode('single')">
                <span class="mode-name">단판</span>
                <span id="record-single" class="mode-record">승률 0% | 연승 0</span>
            </button>
            <button type="button" class="mode-btn" onclick="selectMode('bo3')">
                <span class="mode-name">3전제 (하드피어리스)</span>
                <span id="record-bo3" class="mode-record">승률 0% | 연승 0</span>
            </button>
            <button type="button" class="mode-btn" onclick="selectMode('bo5')">
                <span class="mode-name">5전제 (하드피어리스)</span>
                <span id="record-bo5" class="mode-record">승률 0% | 연승 0</span>
            </button>
            <button type="button" class="mode-btn" id="home-btn-worlds-challenge" onclick="openWorldsChallengeSetup()">
                <span class="mode-name">월즈 도전 (실제 팀 모드 필요)</span>
                <span id="worlds-challenge-status" class="mode-record">실제 팀 모드 OFF</span>
            </button>
            <button type="button" class="mode-btn" id="home-btn-ai-balance">
                <span class="mode-name">AI 밸런스 시뮬 20판</span>
                <span class="mode-record">랜덤 팀 자동 밴픽/경기</span>
            </button>
        </div>
        <div class="home-stats-grid">
            <div class="home-log-panel">
                <h3>최근 경기 기록</h3>
                <div id="home-log-list" class="home-log-list"></div>
            </div>
            <div class="home-log-panel">
                <h3>로컬 랭킹</h3>
                <div id="home-ranking-list" class="home-ranking-list"></div>
            </div>
            <div class="home-log-panel">
                <h3>챔피언 픽/밴 통계</h3>
                <div id="home-champ-stats" class="home-ranking-list"></div>
            </div>
        </div>
        <div class="home-actions">
            <button type="button" class="tutorial-btn" id="home-btn-worlds-open">실제 팀 모드 설정</button>
            <button type="button" class="tutorial-btn" id="home-btn-worlds-disable">실제 팀 모드 해제</button>
            <button type="button" class="tutorial-btn" id="home-btn-tutorial-open">게임 설명 보기</button>
        </div>
        <div class="remote-config">
            <h3>온라인 기록 연동 (Supabase)</h3>
            <div class="remote-config-grid">
                <label for="remote-url">Project URL</label>
                <input id="remote-url" type="text" placeholder="https://xxxx.supabase.co">
                <label for="remote-anon-key">Anon Key</label>
                <input id="remote-anon-key" type="password" placeholder="eyJ...">
            </div>
            <div class="remote-actions">
                <button type="button" class="tutorial-btn" id="home-btn-remote-save">온라인 기록 연결</button>
                <button type="button" class="tutorial-btn" id="home-btn-remote-refresh">온라인 기록 새로고침</button>
                <button type="button" class="tutorial-btn" id="home-btn-remote-disable">온라인 기록 해제</button>
            </div>
            <div id="remote-status" class="remote-status">온라인 기록: 비활성</div>
            <p class="home-note">Supabase Table: <code>match_logs</code> (RLS + anon insert/select 허용 필요)</p>
        </div>
        <p class="home-note">기록/랭킹은 현재 브라우저(이 기기) 기준으로 저장됩니다.</p>
    </div>
</div>

<div id="game-shell">
<div class="header">
    <div id="header-main-row" style="display:flex; justify-content: space-between; font-weight: bold;">
        <div id="blue-info" class="team-head team-head-blue">
            <span class="team-head-name">AI TEAM (BLUE)</span>
            <span class="team-head-sub">성향 정보</span>
        </div>
        <span id="step-msg" style="color:var(--gold); font-size: 20px;">밴픽 시작</span>
        <div id="red-info" class="team-head team-head-red">
            <span class="team-head-name">MY TEAM (RED)</span>
            <span class="team-head-sub">성향 정보</span>
        </div>
    </div>
    <div id="series-info" style="font-size:12px; color:#9fb3c2; margin-top:6px; text-align:center;">BO5 준비중</div>
    <div id="realteam-mode-badge" class="realteam-mode-badge off">실제 팀 모드 OFF</div>
    <span id="yt-bgm-status" class="bgm-file" style="display:none;">자동 재생 시도중...</span>
    <div class="winrate-track">
        <div id="blue-win-bar"></div>
        <div class="wr-label">
            <span id="b-wr-txt">50.0%</span>
            <span id="r-wr-txt">50.0%</span>
        </div>
    </div>
</div>
<div id="mobile-team-mini" class="mobile-team-mini"></div>

<div class="main">
    <div class="side" id="blue-side">
        <div class="ban-container" id="b-bans"></div>
        <div id="b-picks"></div>
        <div id="b-team-summary" class="team-summary"></div>
    </div>

    <div class="center">
        <div class="center-toolbar">
            <input type="text" id="search" class="search-input" placeholder="챔피언 검색..." oninput="renderPool()">
            <div class="locked-wrap">
                <div class="locked-title">하드 피어리스 잠금 챔피언</div>
                <div id="locked-list" class="locked-list"></div>
            </div>
            <div class="filters-row">
                <div class="filter-group">
                    <div class="filter-label">포지션 필터</div>
                    <div class="pos-nav" id="pos-nav">
                        <button type="button" class="pos-filter-btn active" data-pos="ALL">ALL</button>
                        <button type="button" class="pos-filter-btn" data-pos="TOP">TOP</button>
                        <button type="button" class="pos-filter-btn" data-pos="JNG">JNG</button>
                        <button type="button" class="pos-filter-btn" data-pos="MID">MID</button>
                        <button type="button" class="pos-filter-btn" data-pos="ADC">ADC</button>
                        <button type="button" class="pos-filter-btn" data-pos="SPT">SPT</button>
                    </div>
                </div>
                <div class="filter-group">
                    <div class="filter-label">유형 필터</div>
                    <div class="pos-nav" id="type-nav">
                        <button type="button" class="pos-filter-btn active" data-type="ALL">ALL</button>
                        <button type="button" class="pos-filter-btn" data-type="Dive">돌진</button>
                        <button type="button" class="pos-filter-btn" data-type="Poke">포킹</button>
                        <button type="button" class="pos-filter-btn" data-type="Anti">받아치기</button>
                    </div>
                </div>
                <div class="filter-group">
                    <div class="filter-label">데미지 필터</div>
                    <div class="pos-nav" id="dmgtype-nav">
                        <button type="button" class="pos-filter-btn active" data-dmgtype="ALL">ALL</button>
                        <button type="button" class="pos-filter-btn" data-dmgtype="AD">AD</button>
                        <button type="button" class="pos-filter-btn" data-dmgtype="AP">AP</button>
                        <button type="button" class="pos-filter-btn" data-dmgtype="Hybrid">하이브리드</button>
                    </div>
                </div>
                <div class="filter-group">
                    <div class="filter-label">역할 필터</div>
                    <div class="pos-nav" id="combat-nav">
                        <button type="button" class="pos-filter-btn active" data-combat="ALL">ALL</button>
                        <button type="button" class="pos-filter-btn" data-combat="Dealer">딜러</button>
                        <button type="button" class="pos-filter-btn" data-combat="Tanker">탱커</button>
                    </div>
                </div>
            </div>
            <div id="pick-confirm" class="pick-confirm hidden">
                <div class="pick-confirm-text">선택됨: <b id="pick-confirm-name">-</b> <span id="pick-confirm-type" style="color:#9fb3c2;"></span></div>
                <div class="pick-confirm-actions">
                    <button type="button" class="pick-confirm-btn primary" onclick="confirmPendingPick()">픽 확정</button>
                    <button type="button" class="pick-confirm-btn" onclick="cancelPendingPick()">취소</button>
                </div>
            </div>
        </div>
        <div class="grid" id="champ-grid"></div>
    </div>

    <div class="side" id="red-side">
        <div class="ban-container" id="r-bans" style="flex-direction: row-reverse;"></div>
        <div id="r-picks"></div>
        <div id="r-team-summary" class="team-summary"></div>
    </div>
</div>

<div id="tooltip" class="tooltip"></div>

<div id="action-confirm-modal" class="action-confirm-modal">
    <div class="action-confirm-card">
        <div class="action-confirm-title" id="action-confirm-title">선택 확인</div>
        <div class="action-confirm-name" id="action-confirm-name">-</div>
        <div class="action-confirm-actions">
            <button type="button" class="pick-confirm-btn primary" id="action-confirm-yes" onclick="confirmPendingPick()">확정</button>
            <button type="button" class="pick-confirm-btn" onclick="cancelPendingPick()">취소</button>
        </div>
    </div>
</div>
<div id="mobile-champ-modal" class="mobile-champ-modal">
    <div class="mobile-champ-sheet">
        <div class="mobile-champ-head">
            <strong id="mobile-champ-title">챔피언 정보</strong>
            <button type="button" class="mobile-close-btn" onclick="closeMobileChampionInfo()">닫기</button>
        </div>
        <div id="mobile-champ-body" class="mobile-champ-body"></div>
    </div>
</div>
<div id="player-info-modal">
    <div class="player-info-card">
        <div class="player-info-head">
            <strong id="player-info-title">선수 상세 정보</strong>
            <button type="button" class="mobile-close-btn" onclick="closePlayerInfoModal()">닫기</button>
        </div>
        <div id="player-info-body" class="player-info-body"></div>
    </div>
</div>
<div id="graph-help-modal">
    <div class="graph-help-card">
        <div class="graph-help-title">그래프 설명</div>
        <div id="graph-help-body" class="graph-help-body"></div>
        <div class="graph-help-actions">
            <button type="button" class="tutorial-btn" onclick="closeGraphHelp()">닫기</button>
        </div>
    </div>
</div>
<div id="side-select-modal">
    <div class="side-select-card">
        <h2 class="side-title" id="side-title">모드 선택됨</h2>
        <p class="side-desc" id="side-desc">진영을 선택하세요. 선택하지 않은 팀은 컴퓨터가 자동 픽합니다.</p>
        <div class="side-btn-wrap">
            <button class="side-btn blue" type="button" onclick="chooseSide('blue')">블루팀 선택</button>
            <button class="side-btn red" type="button" onclick="chooseSide('red')">레드팀 선택</button>
        </div>
    </div>
</div>
<div id="strategy-modal">
    <div class="strategy-card">
        <h2 class="side-title">팀 전략 설정</h2>
        <p class="side-desc">이번 세트 컨셉을 선택하면 적합 챔피언 보너스와 부조화 페널티가 적용됩니다.</p>
        <div id="strategy-list" class="strategy-list"></div>
        <div id="strategy-guide" class="strategy-guide"></div>
        <div class="strategy-actions">
            <button type="button" class="tutorial-btn" onclick="confirmStrategyAndStart()">이 전략으로 시작</button>
        </div>
    </div>
</div>
<div id="worlds-modal">
    <div class="worlds-card">
        <h2 class="side-title">실제 팀 모드 설정 (베타)</h2>
        <p class="side-desc">팀을 선택하면 팀 성향(선호 전략) + 선수 주챔 기반 보정이 적용됩니다.</p>
        <div class="worlds-setup-row">
            <label>내 팀</label>
            <select id="worlds-my-team" onchange="onWorldsTeamChange()"></select>
            <label>상대 팀</label>
            <select id="worlds-enemy-team" onchange="onWorldsTeamChange()"></select>
        </div>
        <div id="worlds-status" class="worlds-status">실제 팀 모드 비활성화 (OFF)</div>
        <div class="worlds-roster-grid">
            <div id="worlds-my-roster" class="worlds-roster"></div>
            <div id="worlds-enemy-roster" class="worlds-roster"></div>
        </div>
        <div class="strategy-actions">
            <button type="button" class="tutorial-btn" onclick="confirmWorldsMode()">적용</button>
            <button type="button" class="tutorial-btn" onclick="closeWorldsModal()">닫기</button>
        </div>
    </div>
</div>
<div id="worlds-challenge-modal">
    <div class="worlds-challenge-card">
        <h2 class="side-title">월즈 도전 설정</h2>
        <p class="side-desc">8팀 토너먼트: 8강 BO1, 4강 BO3(피어리스), 결승 BO5(피어리스)</p>
        <div id="worlds-challenge-mode-state" class="worlds-status">실제 팀 모드 OFF</div>
        <div class="worlds-setup-row">
            <label>내 팀</label>
            <select id="challenge-user-team" onchange="onChallengeSetupChange()"></select>
            <label>참가팀 구성</label>
            <div class="challenge-toggle-row">
                <button type="button" id="challenge-random-btn" class="tutorial-btn" onclick="setChallengeSelectionMode(true)">랜덤 설정</button>
                <button type="button" id="challenge-manual-btn" class="tutorial-btn" onclick="setChallengeSelectionMode(false)">직접 지정</button>
            </div>
        </div>
        <div id="challenge-manual-wrap" class="challenge-manual-wrap">
            <div class="challenge-manual-title">LCK 3팀 + 해외 4팀 직접 지정</div>
            <div class="challenge-manual-grid">
                <div>
                    <div class="challenge-col-title">LCK 슬롯</div>
                    <select id="challenge-lck-0" onchange="onChallengeSetupChange()"></select>
                    <select id="challenge-lck-1" onchange="onChallengeSetupChange()"></select>
                    <select id="challenge-lck-2" onchange="onChallengeSetupChange()"></select>
                </div>
                <div>
                    <div class="challenge-col-title">해외 슬롯</div>
                    <select id="challenge-intl-0" onchange="onChallengeSetupChange()"></select>
                    <select id="challenge-intl-1" onchange="onChallengeSetupChange()"></select>
                    <select id="challenge-intl-2" onchange="onChallengeSetupChange()"></select>
                    <select id="challenge-intl-3" onchange="onChallengeSetupChange()"></select>
                </div>
            </div>
        </div>
        <div id="challenge-participants-preview" class="worlds-roster"></div>
        <div class="strategy-actions">
            <button type="button" class="tutorial-btn" onclick="startWorldsChallenge()">월즈 도전 시작</button>
            <button type="button" class="tutorial-btn" onclick="closeWorldsChallengeSetup()">닫기</button>
        </div>
    </div>
</div>
<div id="worlds-challenge-live-modal">
    <div class="worlds-challenge-live-card">
        <h2 class="side-title">월즈 도전 진행</h2>
        <div id="challenge-live-stage" class="challenge-live-stage">대회 준비중...</div>
        <div id="challenge-live-bracket" class="challenge-live-bracket"></div>
        <div id="challenge-live-log" class="challenge-live-log"></div>
        <div class="strategy-actions">
            <button type="button" class="tutorial-btn" onclick="closeWorldsChallengeLive()">닫기</button>
        </div>
    </div>
</div>
<div id="ai-balance-modal">
    <div class="ai-balance-card">
        <h2 class="side-title">AI 밸런스 시뮬레이션</h2>
        <p class="side-desc">AI vs AI 랜덤 팀 대진으로 20경기를 자동 실행하고 챔피언/팀/조합 승률을 누적합니다.</p>
        <div class="strategy-actions">
            <button type="button" class="tutorial-btn" id="ai-balance-run-btn">20판 실행</button>
            <button type="button" class="tutorial-btn" onclick="closeAiBalanceModal()">닫기</button>
        </div>
        <div id="ai-balance-status" class="worlds-status">대기중</div>
        <div id="ai-balance-results" class="challenge-live-log"></div>
    </div>
</div>
<div id="tutorial-modal">
    <div class="tutorial-card">
        <h2 class="tutorial-title">게임 설명</h2>
        <div id="tutorial-step-title" class="tutorial-step-title">게임 소개</div>
        <div id="tutorial-step-body" class="tutorial-step-body"></div>
        <div id="tutorial-step-index" class="tutorial-step-index">1 / 1</div>
        <div class="tutorial-nav">
            <button class="tutorial-btn" type="button" onclick="prevTutorialStep()">이전</button>
            <button class="tutorial-btn" type="button" onclick="nextTutorialStep()">다음</button>
            <button class="tutorial-btn" type="button" onclick="closeTutorial()">닫기</button>
        </div>
    </div>
</div>
<div id="champ-stats-modal">
    <div class="tutorial-card champ-stats-card">
        <h2 class="tutorial-title">전체 챔피언 통계</h2>
        <div id="champ-stats-body" class="champ-stats-body"></div>
        <div class="tutorial-nav">
            <button class="tutorial-btn" type="button" onclick="closeChampionStatsModal()">닫기</button>
        </div>
    </div>
</div>

<div id="result-modal">
    <div class="result-card">
        <h1 id="winner-text" style="font-size: 48px; margin-top:0;">BLUE WIN</h1>
        <div id="final-stats" style="margin: 20px 0; line-height: 2;"></div>
        <button id="result-next-btn" onclick="handleNextAction()" style="padding:12px 30px; background:var(--gold); border:none; cursor:pointer; font-weight:bold; font-size: 16px;">다음 세트</button>
    </div>
</div>
<div class="yt-player-wrap">
    <iframe
        id="yt-bgm"
        src=""
        title="BGM"
        allow="autoplay; encrypted-media; picture-in-picture"
        referrerpolicy="strict-origin-when-cross-origin"
        allowfullscreen
    ></iframe>
</div>
</div>

<script src="data/champions.js?v=20260227-11"></script>
<script src="data/traits.js?v=20260227-11"></script>
<script src="scripts/app.js?v=20260227-20"></script>
</body>
</html>
